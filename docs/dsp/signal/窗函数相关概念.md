# 窗函数概念



**为什么要加窗**

加窗主要是为了使时域信号似乎更好地满足FFT处理的周期性要求，减少泄漏。注意，窗函数只能减少泄漏，不能消除泄漏。



![](D:\blog\docs\dsp\signal\windows_decrease_leakage.jpg)

![](D:\blog\docs\dsp\signal\windowing_effect.PNG)



**窗函数的频谱特征**



特征定义

![频谱特征](D:\blog\docs\dsp\signal\window_spectrum_attributes.jpg)



- 主瓣宽度（也称为有效噪声带宽，ENBW）

  主瓣宽度主要影响信号能量分布和频率分辨能力。频率的实际分辨能力为有效噪声带宽乘以频率分辨率（采样频率/样本个数？），因此，主瓣越宽，有效噪声带宽越宽，在频率分辨率相同的情况下，频率的分辨能力越差。

  如下图所示，红色为平顶窗（3.77∆f），黑色为汉宁窗（1.5∆f），蓝色为信号频率，可以明显地看出，主瓣越窄，频率分辨越准确。对于窗函数宽的主瓣而言，如果有邻近的小峰值频率，则越难辨别出来。

  ![频率分辨度](D:\blog\docs\dsp\signal\frequency_distinguishability.jpg)

- 幅值失真度

- 最高旁瓣高度

  旁瓣越高，说明能量泄漏越严重

- 旁瓣衰减速率

  衰减越慢，频谱拖尾越严重。

  

  对50.5Hz（频率分辨率为1Hz）的信号分别施加矩形窗（红色）、汉宁窗（绿色）和平顶窗（蓝色），矩形窗的频谱拖尾严重。

  ![tail](D:\blog\docs\dsp\signal\windows_tail_comparison.jpg)



加窗的主要想法是用比较光滑的窗函数代替截取信号样本的矩形窗函数，也就是对截断后的时域信号进行特定的不等计权，使被截断后的时域波形两端突变变得平滑些，以此压低谱窗的旁瓣。因为旁瓣泄露量最大，旁瓣小了泄露也相应减少了。









对于窗函数的选用总的原则是:

- 保持最大信息和消除旁瓣的综合效果
- 使窗函数频谱中的主瓣宽度应尽量窄，以获得较陡的过渡带
- 旁瓣衰减应尽量大，以提高阻带的衰减



重要的问题是在于根据信号的性质和研究目的来选用窗函数

- 如果截断的信号仍为周期信号，则不存在泄漏，无须加窗，相当于加矩形窗。

- 如果信号是随机信号或者未知信号，或者有多个频率分量，测试关注的是频率点而非能量大小，建议选择汉宁窗，像LMS Test.Lab中默认加的就是汉宁窗。频谱中的两侧瓣的高度趋于零，能量相对集中在主瓣，就接近于真实的频谱，频率识别精度高

- 对于校准目的，则要求幅值精确，平顶窗是个不错的选择。

- 如果同时要求幅值精度和频率精度，可选择凯塞窗。

- 如果检测两个频率相近、幅值不同的信号，建议用布莱克曼窗。

- 锤击法试验力信号加力窗，响应可加指数窗。



SNR示例

在[信号处理](https://zh.wikipedia.org/wiki/信号处理)中，透过某些操作，可以利用信号和噪声之间性质的差异，来提高信号某些方面的品质。当某个正弦信号随机地叠加的破坏性噪声，频谱分析能区别的信号与噪声的分量，往往能使检测信号的某些特性更容易，如测量振幅和频率。比如说，若将大多数的正弦信号能量集中于一个频率附近，并将噪声均匀分布，能有效的改善[信噪比](https://zh.wikipedia.org/wiki/信噪比)（signal to noise ratio, SNR）。**处理增益**通常用来描述SNR改善的程度。频谱分析的处理增益取决于窗函数的**噪声带宽（B）**和潜在的**扇形损失**。这些效果可能部分抵消，因为窗函数有最少的扇形自然有最大的渗漏。

![](D:\blog\docs\dsp\signal\Processing_losses_for_3_window_functions.gif)
右图描述了三种不同的窗函数对相同的数据的影响。此数据包含两个相等强度的正弦信号与外加的噪声。两正弦波的频率被定为其中一个无扇形而另一个有最大扇形。两个正弦信号在Hann Window下都造成比Blackman–Harris window更少的信噪比损耗。 一般情况下，这防止我们在低动态范围的应用采用高动态范围的窗。



常见窗函数的特征以及数据比较

```markdown
[窗函数比较](窗函数比较.md ':include')
```









特别推荐 

- [什么是窗函数? - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/24318554)
- [窗函数 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/wiki/窗函数)
- [时域加窗和频域加窗](https://www.sohu.com/a/301631153_695278)